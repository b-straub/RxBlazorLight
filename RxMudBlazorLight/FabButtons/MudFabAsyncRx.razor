@inherits MudFabAsyncBaseRx<T>
@typeparam T

<MudBadge Visible=@(_buttonRx is not null && _useProgressIcon && _buttonRx.GetBadgeIcon(State, IconVariant, false, ForceBadge) != string.Empty)
          Icon=@_buttonRx!.GetBadgeIcon(State, IconVariant, false, ForceBadge) Color=@(_buttonRx.Disabled ? Color.Default : Color) Overlap="true" Bordered="true">
    @RenderBase()
</MudBadge>

@code {
    [Parameter, EditorRequired]
    public required Func<IStateAsync<T>, Task> ChangeStateAsync { get; init; }

    [Parameter]
    public bool HasProgress { get; set; } = false;

    [Parameter]
    public bool ForceBadge { get; set; } = false;

    private bool _useProgressIcon;

    protected override void OnInitialized()
    {
        _changeStateAsync = ChangeStateAsync;
        _hasProgress = HasProgress;
        _forceBadge = ForceBadge;
        _useProgressIcon = _hasProgress && ((StartIcon is not null && EndIcon is not null) || _forceBadge);

        base.OnInitialized();
    }
}
